(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var o=e.g.document;if(!t&&o&&(o.currentScript&&(t=o.currentScript.src),!t)){var r=o.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.p;const t=e.p+"../audio/click.mp3",o=e.p+"../audio/explosion_1.mp3",r=e.p+"../audio/explosion_2.mp3",i=e.p+"../audio/explosion_3.mp3",s=e.p+"../audio/end.mp3",n=document.querySelector("canvas"),l=n.getContext("2d"),a=360,c=640/a;n.width=a,n.height=640;let d=1;const h=document.querySelector(".wrapper"),u=document.querySelector(".score"),p=document.querySelector(".highscore"),m=document.querySelector(".result"),f=document.querySelector(".play"),g=document.querySelector(".home"),y=document.querySelector(".restart"),w=document.querySelector(".post"),v=document.querySelector(".invite"),S=document.querySelector(".volume"),x=document.querySelector(".group"),b=document.querySelector(".buttons"),q=document.querySelector(".screen--start"),M=document.querySelector(".screen--game"),k=document.querySelector(".screen--end"),E=document.querySelector(".preloader");class C{constructor(e,t,o,r,i){this.x=e,this.y=t,this.radius=o,this.speed=r,this.color=i,this.alpha=1}draw(){l.save(),l.globalAlpha=this.alpha,l.beginPath(),l.arc(this.x*d,this.y*d,this.radius*d,0,2*Math.PI),l.fillStyle=this.color,l.fill(),l.strokeStyle="rgb(17, 21, 66)",l.stroke(),l.closePath(),l.restore()}update(){this.draw(),this.y+=this.speed}}class L{constructor(e,t,o,r,i){this.x=e,this.y=t,this.radius=o,this.speed=r,this.color=i,this.alpha=1}draw(){l.save(),l.globalAlpha=this.alpha,l.beginPath(),l.arc(this.x*d,this.y*d,this.radius*d,0,2*Math.PI),l.fillStyle=this.color,l.fill(),l.closePath(),l.restore()}update(){this.draw(),this.speed.x*=.98,this.speed.y*=.98,this.x+=this.speed.x,this.y+=this.speed.y,this.alpha-=.03}}let P=!1,T=!0,W=0;setTimeout((()=>{E.classList.add("hidden")}),1e3);let A=1300,$=1e3,B=60,_=70,H=1.55;const V=["--color-purple","--color-blue","--color-green","--color-yellow","--color-red"].map((e=>getComputedStyle(document.documentElement).getPropertyValue(e).trimStart())),I=[o,r,i];let K=[],G=[],j={};function O(e){let t=Math.abs(e);return t%=100,t>=5&&t<=20?"очков":(t%=10,1===t?"очко":t>=2&&t<=4?"очка":"очков")}function z(){P=!1,K.forEach((e=>{e.speed=0})),R(s),A=1300,$=1e3,B=60,_=70,H=1.55,J(null,"add","left",[M]),function(){const e=W;W=0,m.firstElementChild.textContent=e,u.textContent=0,J(null,"remove","right",[k])}()}function F(e,t){e.classList.add("active"),setTimeout((()=>{e.classList.remove("active")}),t)}function J(e,t,o,r){let i;"start"!==e||P||setTimeout((()=>{P=!0,m.classList.remove("record"),function e(){const t=Math.random()*(A-$)+$;setTimeout((()=>{if(P){const t=Math.random()*(_-B)+B,o=t+5,r=a-t-5,i=Math.random()*(r-o)+o,s=-t,n=H,l=V[Math.floor(Math.random()*V.length)];document.hidden||K.push(new C(i,s,t,n,l)),e()}}),t)}()}),1100),i="left"===o?"hidden--left":"hidden--right",function(e,t,o=0,r){setTimeout((()=>{e.forEach((e=>{"add"===t?e.classList.add(r):e.classList.remove(r)}))}),o)}(r,t,500,i)}function N(){const e=window.innerHeight/window.innerWidth;c>e?(n.width=window.innerHeight/c,n.height=window.innerHeight,d=window.innerHeight/640,h.style=`--scale:${d}`):(n.width=window.innerWidth,n.height=window.innerWidth*c,d=window.innerWidth/a,h.style=`--scale:${d}`)}function R(e,t=!0){if(T){const o=new Audio,r=`./${e.split("../")[1]}`,i=r.split("audio/")[1].split(".")[0];o.src=r,j[i]=o,t&&j[i].play()}}setInterval((()=>{l.clearRect(0,0,n.width,n.height),K.forEach((e=>{e.y>=555-e.radius&&P&&(e.speed=0,z()),e.speed<=0&&(e.alpha-=.04,e.alpha<=0&&(e.alpha=0,K.splice(e,1))),e.update()})),G.forEach((e=>{e.alpha<=0?G.splice(e,1):e.update()}))}),16.666),h.addEventListener("click",(e=>{const o=e.target;if(o===f){let e;J("start","add","left",[q]),e=M.classList.contains("hidden--right")?"right":"left",J(null,"remove",e,[M]),F(f,200),R(t)}else if(o===S)T=!T,S.classList.toggle("off"),F(S,200),R(t);else if(o===x)vkBridge.send("VKWebAppJoinGroup",{group_id:213140436}),F(x,200),R(t);else if(o===w){const e=p.firstElementChild.textContent;vkBridge.send("VKWebAppStorageGet",{keys:["userHighscore"]}).then((()=>{vkBridge.send("VKWebAppShowWallPostBox",{message:`Мой рекорд в игре Лопай шарики! 🌈 - ${e} ${O(e)}! сможешь побить?\n\nOrby Games (vk.com/orby.games) - бесплатные игры для ВКонтакте. Присоединяйтесь!\n\n#игры #vkgames #directgames`,attachments:"https://vk.com/app8158284"})})),F(w,200),R(t)}else if(o===v)vkBridge.send("VKWebAppShowInviteBox"),F(v,200),R(t);else if(o===y)J(null,"add","right",[k]),J("start","remove","left",[M]),F(y,200),R(t);else if(o===g)J(null,"add","right",[k]),J(null,"remove","left",[q]),J(null,"remove","left",[M]),J(null,"add","right",[M]),F(g,200),R(t);else if(o.parentElement===b&&P&&K.length){const e=window.getComputedStyle(o).backgroundColor,t=K.find((t=>t.color===e));if(t===K[0]){const e=Math.floor(3*Math.random());R(I[e],!1),T&&(0===e?j.explosion_1.play():1===e?j.explosion_2.play():2===e&&j.explosion_3.play());const o=t.color;t.color="#fff",t.radius+=t.radius/5,setTimeout((()=>{t.color=o,K.shift(K.indexOf(t),1);for(let e=0;e<t.radius/5;e++)G.push(new L(t.x,t.y,Math.random()*t.radius/3,{x:(Math.random()-.5)*(20*Math.random()),y:(Math.random()-.5)*(20*Math.random())},t.color))}),50),W++,u.textContent=W,F(u,200),A>=525&&(A-=12),$>=525&&($-=16),B>=8&&(B-=.25),_>=14&&(_-=.15),H<=3.5&&(H+=.025)}else z()}})),N(),window.addEventListener("resize",N)})();