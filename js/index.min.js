(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var o=e.g.document;if(!t&&o&&(o.currentScript&&(t=o.currentScript.src),!t)){var r=o.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.p;const t=e.p+"../audio/click.mp3",o=e.p+"../audio/explosion_1.mp3",r=e.p+"../audio/explosion_2.mp3",i=e.p+"../audio/explosion_3.mp3",s=e.p+"../audio/end.mp3",n=document.querySelector("canvas"),l=n.getContext("2d"),a=360,c=640/a;n.width=a,n.height=640;let d=1;const h=document.querySelector(".wrapper"),u=document.querySelector(".score"),p=document.querySelector(".highscore"),m=document.querySelector(".result"),f=document.querySelector(".play"),g=document.querySelector(".home"),y=document.querySelector(".restart"),w=document.querySelector(".post"),v=document.querySelector(".invite"),S=document.querySelector(".volume"),x=document.querySelector(".group"),b=document.querySelector(".buttons"),q=document.querySelector(".screen--start"),M=document.querySelector(".screen--game"),k=document.querySelector(".screen--end"),E=document.querySelector(".preloader");class C{constructor(e,t,o,r,i){this.x=e,this.y=t,this.radius=o,this.speed=r,this.color=i,this.alpha=1}draw(){l.save(),l.globalAlpha=this.alpha,l.beginPath(),l.arc(this.x*d,this.y*d,this.radius*d,0,2*Math.PI),l.fillStyle=this.color,l.fill(),l.strokeStyle="rgb(17, 21, 66)",l.stroke(),l.closePath(),l.restore()}update(){this.draw(),this.y+=this.speed}}class L{constructor(e,t,o,r,i){this.x=e,this.y=t,this.radius=o,this.speed=r,this.color=i,this.alpha=1}draw(){l.save(),l.globalAlpha=this.alpha,l.beginPath(),l.arc(this.x*d,this.y*d,this.radius*d,0,2*Math.PI),l.fillStyle=this.color,l.fill(),l.closePath(),l.restore()}update(){this.draw(),this.speed.x*=.98,this.speed.y*=.98,this.x+=this.speed.x,this.y+=this.speed.y,this.alpha-=.03}}let A=!1,P=!0,T=0;setTimeout((()=>{E.classList.add("hidden")}),1e3);let W=1300,$=1e3,B=60,_=70,H=1.55;const V=["--color-purple","--color-blue","--color-green","--color-yellow","--color-red"].map((e=>getComputedStyle(document.documentElement).getPropertyValue(e).trimStart())),K=[o,r,i];let G,I,j,D,F=[],O=[],z={};function J(e){let t=Math.abs(e);return t%=100,t>=5&&t<=20?"очков":(t%=10,1===t?"очко":t>=2&&t<=4?"очка":"очков")}function N(){A=!1,F.forEach((e=>{e.speed=0})),X(s),W=1300,$=1e3,B=60,_=70,H=1.55,Q(null,"add","left",[M]),function(){const e=T;T=0,m.firstElementChild.textContent=e,u.textContent=0,Q(null,"remove","right",[k])}()}function R(e,t){e.classList.add("active"),setTimeout((()=>{e.classList.remove("active")}),t)}function Q(e,t,o,r){let i;"start"!==e||A||setTimeout((()=>{A=!0,m.classList.remove("record"),function e(){const t=Math.random()*(W-$)+$;setTimeout((()=>{if(A){const t=Math.random()*(_-B)+B,o=t+5,r=a-t-5,i=Math.random()*(r-o)+o,s=-t,n=H,l=V[Math.floor(Math.random()*V.length)];document.hidden||F.push(new C(i,s,t,n,l)),e()}}),t)}()}),1100),i="left"===o?"hidden--left":"hidden--right",function(e,t,o=0,r){setTimeout((()=>{e.forEach((e=>{"add"===t?e.classList.add(r):e.classList.remove(r)}))}),o)}(r,t,500,i)}function U(){const e=window.innerHeight/window.innerWidth;c>e?(n.width=window.innerHeight/c,n.height=window.innerHeight,d=window.innerHeight/640,h.style=`--scale:${d}`):(n.width=window.innerWidth,n.height=window.innerWidth*c,d=window.innerWidth/a,h.style=`--scale:${d}`)}function X(e){if(P){const t=new Audio,o=`./${e.split("../")[1]}`,r=o.split("audio/")[1].split(".")[0];t.src=o,z[r]=t,z[r].play()}}G=1e3/60,j=Date.now(),function e(){requestAnimationFrame(e),I=Date.now(),D=I-j,D>G&&(j=I-D%G,l.clearRect(0,0,n.width,n.height),F.forEach((e=>{e.y>=555-e.radius&&A&&(e.speed=0,N()),e.speed<=0&&(e.alpha-=.04,e.alpha<=0&&(e.alpha=0,F.splice(e,1))),e.update()})),O.forEach((e=>{e.alpha<=0?O.splice(e,1):e.update()})))}(),h.addEventListener("click",(e=>{const o=e.target;if(o===f){let e;Q("start","add","left",[q]),e=M.classList.contains("hidden--right")?"right":"left",Q(null,"remove",e,[M]),R(f,200),X(t)}else if(o===S)P=!P,S.classList.toggle("off"),R(S,200),X(t);else if(o===x)vkBridge.send("VKWebAppJoinGroup",{group_id:213140436}),R(x,200),X(t);else if(o===w){const e=p.firstElementChild.textContent;vkBridge.send("VKWebAppStorageGet",{keys:["userHighscore2"]}).then((()=>{vkBridge.send("VKWebAppShowWallPostBox",{message:`Мой рекорд в игре Лопай шарики! 🌈 - ${e} ${J(e)}! сможешь побить?\n\nOrby Games (vk.com/orby.games) - бесплатные игры для ВКонтакте. Присоединяйтесь!\n\n#игры #vkgames #directgames`,attachments:"https://vk.com/app8158284"})})),R(w,200),X(t)}else if(o===v)vkBridge.send("VKWebAppShowInviteBox"),R(v,200),X(t);else if(o===y)Q(null,"add","right",[k]),Q("start","remove","left",[M]),R(y,200),X(t);else if(o===g)Q(null,"add","right",[k]),Q(null,"remove","left",[q]),Q(null,"remove","left",[M]),Q(null,"add","right",[M]),R(g,200),X(t);else if(o.parentElement===b&&A&&F.length){const e=window.getComputedStyle(o).backgroundColor,t=F.find((t=>t.color===e));if(t===F[0]){const e=Math.floor(3*Math.random());X(K[e]),0===e?z.explosion_1.play():1===e?z.explosion_2.play():2===e&&z.explosion_3.play();const o=t.color;t.color="#fff",t.radius+=t.radius/5,setTimeout((()=>{t.color=o,F.shift(F.indexOf(t),1);for(let e=0;e<t.radius/5;e++)O.push(new L(t.x,t.y,Math.random()*t.radius/3,{x:(Math.random()-.5)*(20*Math.random()),y:(Math.random()-.5)*(20*Math.random())},t.color))}),50),T++,u.textContent=T,R(u,200),W>=525&&(W-=12),$>=525&&($-=16),B>=8&&(B-=.25),_>=14&&(_-=.15),H<=3.5&&(H+=.025)}else N()}})),U(),window.addEventListener("resize",U)})();